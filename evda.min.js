function EvDa(s){function o(a,b,h){var i=c[a],e;c[a]=b;f(l,function(c){e=g[c+a];f(e,function(c){c(b,{meta:h,old:i,now:b,key:a,del:function(){c.X=1}})});f(e,function(a){a.X&&m(a)})});j[a]=0}function t(a,b,h){function i(c){d--;p+=c===!1;d||(p||o(a,b,h),j[a]=0)}var e=n+a,d=g[e].length,p=0;f(g[e],function(d){d(b,{meta:h,old:c[a],done:i,key:a,del:function(){m(d)}})})}function u(a,b,c){f(q([a]),function(a){j[a]||(j[a]=1,g[n+a]?t(a,b,c):o(a,b,c))})}function m(a){f(a.$,function(b){g[b]=_.without(g[b],a)})}
function d(a,b,h){var i=arguments.length,e={};return i==1?_.isObject(a)?(f(a,function(a,b){e[b]=d(b,a)}),e):a.search(/[*?]/)+1?_.select(_.keys(c),function(b){return b.match(a)}):c[a]:i?d[_.isFunction(b)?"when":"set"](a,b,h):{data:c,events:g}}var f=_.each,r=_.extend,q=_.flatten,c=s||{},k={},n="test",l=["when","after",n],g={},j={};f(l,function(a){d[a]=function(b,c){c.$||(c.$=[]);f(q([b]),function(b){(g[a+b]||(g[a+b]=[])).push(c);c.$.push(a+b)});return c}});l.pop();return r(d,{once:function(a,b){return r(d.when(a,
b),{X:1})},setter:function(a,b){k[a]=b;a in c&&d.isset(a)},isset:function(a,b){k[a]&&(k[a](),k[a]=0);return b?a in c?b(c[a]):d.once(a,b):a in c},set:function(a,b,c){u(a,arguments.length-1?b:1,c)},unset:function(a){delete c[a]},del:m})};
