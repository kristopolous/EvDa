function EvDa(a){function H(a){return a.match(/[?*]/)}function I(a,b){return H(a)?q(n(b?b:B),function(b){return b.match(a)}):a}function J(a,b){var c={};return e(a)?(k(a,function(){c[a]=b(a)}),c):b(a)}function K(a){if(a in B)return B[a];var b=a.split("."),c=b.pop(),d=b.join(".");if(d){var e=K(d);if(i(e)&&c in e)return e[c]}}function L(a,b,d){if(0===arguments.length)return{data:B,setters:E,events:G,globs:F};if(e(a)){var g=c.call(arguments,1);return s(a,function(a){return L.apply(L.context,[a].concat(g))})}if(1==arguments.length){if(i(a)){var h={};return k(a,function(a,b){h[a]=L(a,b,d,0,1)}),k(h,function(b){f(h[b])&&!f(a[b])&&(a[b]=h[b]())}),P(n(h)[0]),a}return J(a,K)}return L[f(b)?w:"set"].apply(this,arguments)}function M(a){k(a.$,function(b){var c=H(b)?F:G;c[b]=o(c[b],a)})}function N(a,b,c){if(e(a)){var d=a.pop();return N(I(d),function(c,d){var e=1==a.length?a[0]:a;return N(e,b,d)},c)}return i(a)?(k(a,function(b,d){H(b)?u(b,J(b,function(){return N(b,d,c)})):a[b]=N(b,d,c)}),a):(E[a]&&(E[a](function(b){L.set.call(L.context,a,b,c)}),delete E[a]),b?a in B?b.call(L.context,B[a],c):L(a,b,u(c||{},y)):a in B)}function O(a,b,c,d){a.S||(a.call(b,c,d),a.once&&M(a))}function P(a){var b=a.split("."),d=b.pop();parts_obj=[],parts_obj[d]=B[a],L.extend.apply(L.context,[b.join("."),parts_obj].concat(c.call(arguments,1)))}var b="__base",c=Array.prototype.slice,d=Object.prototype.toString,e=[].isArray||function(a){return"[object Array]"===d.call(a)},f=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},g=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},h=function(a){return"[object Number]"===d.call(a)},i=function(a){return f(a)||g(a)||h(a)||e(a)?!1:null==a?"object"==String(a):"[object Object]"===d.call(a)||!0},j=function(a){return c.call(a)},k=[].forEach?function(a,b){if(e(a)||a.length)j(a).forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(e(a))for(var c=0,d=a.length;d>c;c++)b(a[c],c);else for(var f in a)b(f,a[f])},l=function(a){return a.length?a[a.length-1]:void 0},m=function(a){var b=[];for(var c in a)b.push(a[c]);return b},n={}.keys||function(a){if(e(a))return a;var b=[];for(var c in a)b.push(c);return b},o=function(a,b){var c=[];return k(a,function(a){a!==b&&c.push(a)}),c},p=function(a){var b,c=[];return k(n(a).sort(),function(a){a!=b&&(b=a,c.push(a))}),c},q=function(a,b){var c=[];return k(a,function(a){b(a)&&c.push(a)}),c},r=function(a){return a&&"length"in a?a.length:0},s=[].map?function(a,b){return a.map(b)}:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b(a[d],d));return c},t=function(a){return e(a)?c.call(a):i(a)?u(a,{}):a},u=function(a){return k(c.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},v="first",w="on",x="after",y={once:1},z={},A={},B=a||{},D=[],E={},F={},G={};return k([v,w,x,"test","or"],function(a){L[a]=function(c,d,e){var f=G;return d||(d=c,c=b),(d.$||(d.$=[])).push(a+c),H(c)&&(f=F),(f[a+c]||(f[a+c]=[])).push(d),u(d,e)}}),u(L,{_:{},context:this,list:{},isPaused:!1,db:B,setterMap:E,events:G,del:M,whenSet:N,isset:N,pause:function(){return L.isPaused?!1:(L.isPaused=!0,L._.set=L.set,L.set=function(){D.push(["set",arguments])},!0)},play:function(){if(L.isPaused){L.isPaused=!1;var a=EvDa();return L.set=L._.set,k(D,function(b){a[b[0]].apply(a,b[1])}),D=[],L(a.db),!0}return!1},setter:function(a,b){return E[a]=b,G[w+a]?N(a):void 0},when:function(a,b,d){if(i(a)){var h={},j={},l=function(a,b){j[b.key]=!1,b()},n=function(a,d){j[d.key]=!0,-1==m(j).indexOf(!1)&&b.apply(L.context,c.call(arguments))};return k(a,function(a,b){h[a+"-test"]=L.test(a,l),h[a]=L.when(a,b,n),j[a]=!1}),h}if(g(b))try{var o=new Function("x","return x"+b);o(),b=o}catch(p){}return L(a,function(a){(e(b)&&b.sort().join("")===a.sort().join("")||f(b)&&b(a)||a===b)&&d.apply(L.context,c.call(arguments))})},empty:function(){for(var a in B)delete B[a]},incr:function(a,b){return b=b||1,L.set(a,h(B[a])?B[a]+b:b)},decr:function(a,b){return b=b||1,L.set(a,B[a]-b||0)},push:function(a,c){return 1==r(arguments)&&(c=a,a=b),L.set(a,[].concat(B[a]||[],[c]))},pop:function(a){return L.set(a||b,B[a].slice(0,-1))},traceList:[],group:function(a){var b=j(arguments),a=b.shift(),c=L.apply(0,b);return L.list[a]||(L.list[a]=[]),f(c)?L.list[a].push(c):k(c,function(b){L.list[a].push(b)}),function(){return L.group.apply(0,[a].concat(j(arguments)))}},extend:function(a,b){return L.set.apply(L.context,[a,u({},B[a]||{},b)].concat(c.call(arguments,2)))},set:function(a,b,d,e,f){if(1==arguments.length){var g=function(){L.set.apply(L.context,[a].concat(c.call(arguments)))};return L.set.call(L.context,a,void 0),g}if(z[a]>0)return B[a];z[a]=(z[a]||0)+1;var i,n,h="test"+a,j=c.call(arguments),l=r(G[h]),m=l&&!e,o=m?function(c){return n|=c===!1,--l||(n?k(G["or"+a]||[],function(a){O(a,L.context,b,d)}):L.set(a,b,d,1)),c}:{};if(o.old=t(B[a]),u(o,{meta:d||{},done:o,result:o,key:a}),m)z[a]--,A[a]!==!0&&(A[a]=!0,k(G[h],function(a){a.call(L.context,b,o)}),A[a]=!1),i=B[a];else{k(L.traceList,function(a){a.call(L.context,j)}),B[a]=b;var p=function(){return k((G[v+a]||[]).concat(G[w+a]||[],G[x+a]||[]),function(a){o.last=O(a,L.context,b,o)}),b};i=f?p:p.call(L.context)}return a.length>0&&P.apply(L.context,[a].concat(c.call(arguments,2))),z[a]=0,i},fire:function(a){L.set(a,B[a])},once:function(a,b,c){return i(a)&&(a=m(a)),e(a)?s(a,function(a){L.once.call(L.context,a,b,c)}):b?L.once(L(a,b,c)):u(a,y)},enable:function(a){return k(L.list[a],function(b){b.S&&b.S[a]&&delete b.S[a],0==r(b.S)&&delete b.S}),L.list[a]},setadd:function(a,b){b=e(b)?b:[b];var c=B[a]||[],d=p(c.concat(b));return c.length!=d.length?L(a,d):d},setdel:function(a,b){var c=B[a]||[],d=o(c,b);return c.length!=d.length?L(a,d):d},disable:function(a){return k(L.list[a],function(b){(b.S||(b.S={}))[a]=!0}),L.list[a]},unset:function(){var a=!0;return k(arguments,function(b){a&=b in B,delete B[b]}),a},find:function(a){return q(n(B),function(b){return b.match(a)})},changed:function(a,c){return c||(c=a,a=b),L.on(a,function(a,b){var d=r(a),e=r(b.old);1==d-e?c.call(L.context,l(a)):d>e&&c.call(L.context,j(a).slice(e))})},sniff:function(){var a={},b=+new Date,c=function(c){a[c[0]]||console.log(+new Date-b,c)},d=function(){},e=c;L.traceList.unshift(function(a){e(a)}),L.sniff=function(b){return arguments.length>0?g(b)?(a[b]=!a[b],"[Un]ignoring "+b):(e=b?c:d,b):n(a)}}}),L.setAdd=L.setadd,L.setDel=L.setdel,L.isSet=L.isset,L.get=L,L.change=L.on,L.add=L.push,L.isArray=e,L}