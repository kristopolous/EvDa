function EvDa(A){function c(a,b,d){if(1==arguments.length){if(v(a)){var j={};f(a,function(a,b){j[a]=c(a,b,d,0,1)});f(j,function(b){m(j[b])&&!m(a[b])&&(a[b]=j[b]())});return a}return q(a)?C(a,function(a){return c(a,b,d)}):e[a]}return c[m(b)?t:"set"].apply(this,arguments)}function y(a){f(a.$,function(b){h[b]=z(h[b],a)})}function k(a,b){if(v(a))return f(a,function(b,c){a[b]=k(b,c)}),a;n[a]&&(n[a](function(b){c.set(a,b)}),delete n[a]);return b?a in e?b(e[a]):c(a,b,D):a in e}var p=Array.prototype.slice,
r=Object.prototype.toString,q=[].isArray||function(a){return"[object Array]"===r.call(a)},m=function(a){return!(!a||!a.constructor||!a.call||!a.apply)},v=function(a){return""===a||a&&a.charCodeAt&&a.substr?!1:null==a?"object"==String(a):"[object Object]"===r.call(a)||!0},f=[].forEach?function(a,b){if(q(a)||a.length)p.call(a).forEach(b);else for(var d in a)b(d,a[d])}:function(a,b){if(q(a))for(var d=0,c=a.length;d<c;d++)b(a[d],d);else for(d in a)b(d,a[d])},w={}.keys||function(a){if(q(a))return a;var b=
[],d;for(d in a)b.push(d);return b},z=function(a,b){var d=[];f(a,function(a){a!==b&&d.push(a)});return d},s=function(a){return a&&"length"in a?a.length:0},C=[].map?function(a,b){return a.map(b)}:function(a,b){for(var d=[],c=0,e=a.length;c<e;c++)d.push(b(a[c],c));return d},x=function(a){f(p.call(arguments,1),function(b){for(var d in b)void 0!==b[d]&&(a[d]=b[d])});return a},t="on",D={once:1},e=A||{},n={},h={};f([t,"after","test"],function(a){c[a]=function(b,d,c){d||(d=b,b="__base");(d.$||(d.$=[])).push(a+
b);(h[a+b]||(h[a+b]=[])).push(d);return x(d,c)}});x(c,{list:{},db:e,setterMap:n,events:h,del:y,whenSet:k,isset:k,setter:function(a,b){n[a]=b;if(h[t+a])return k(a)},when:function(a,b,d){return c(a,function(a){a===b&&d(a)})},incr:function(a){return c.set(a,"[object Number]"===r.call(e[a])?e[a]+1:1)},decr:function(a){return c.set(a,e[a]-1||0)},push:function(a,b){1==s(arguments)&&(b=a,a="__base");return c.set(a,[].concat(e[a]||[],[b]))},pop:function(a){return c.set(a||"__base",e[a].slice(0,-1))},traceList:[],
group:function(a){var b=p.call(arguments);a=b.shift();b=c.apply(0,b);c.list[a]||(c.list[a]=[]);m(b)?c.list[a].push(b):f(b,function(b){c.list[a].push(b)});return function(){return c.group.apply(0,[a].concat(p.call(arguments)))}},set:function(a,b,d,j,B){var g="test"+a,n=p.call(arguments),m=s(h[g]),k,r=d||{},l;l=e[a];l=q(l)?p.call(l):v(l)?x(l,{}):l;var u={meta:r,old:l,key:a,done:function(g){k|=!1===g;--m||k||c.set(a,b,d,1)}};u.result=u.done;f(c.traceList,function(a){a(n)});if(m&&!j)f(h[g],function(a){a(b,
u)});else return e[a]=b,g=function(){f((h[t+a]||[]).concat(h["after"+a]||[]),function(a){a.S||(a(b,u),a.once&&y(a))});return b},B?g:g();return e[a]},once:function(a,b){return c(a,b,{once:!0})},enable:function(a){f(c.list[a],function(b){b.S&&b.S[a]&&delete b.S[a];0==s(b.S)&&delete b.S});return c.list[a]},setadd:function(a,b){var d=c,j=(e[a]||[]).concat([b]),h,g=[];f(w(j).sort(),function(a){a!=h&&(h=a,g.push(a))});return d(a,g)},setdel:function(a,b){return c(a,z(e[a]||[],b))},disable:function(a){f(c.list[a],
function(b){(b.S||(b.S={}))[a]=!0});return c.list[a]},unset:function(){var a=!0;f(arguments,function(b){a&=b in e;delete e[b]});return a},find:function(a){var b=w(e),c=[];f(b,function(b){b.match(a)&&c.push(b)});return c},changed:function(a,b){b||(b=a,a="__base");return c.on(a,function(a,c){var e=s(a),g=s(c.old);1==e-g?b(a.length?a[a.length-1]:void 0):e>g&&b(p.call(a).slice(g))})},sniff:function(){var a={},b=+new Date,d=function(c){a[c[0]]||console.log(+new Date-b,c)},e=function(){},f=d;c.traceList.unshift(function(a){f(a)});
c.sniff=function(b){if(0<arguments.length){if(""===b||b&&b.charCodeAt&&b.substr)return a[b]=!a[b],"[Un]ignoring "+b;f=b?d:e;return b}return w(a)}}});c.setAdd=c.setadd;c.setDel=c.setdel;c.isSet=c.isset;c.get=c;c.change=c.on;c.add=c.push;return c};
