function EvDa(p){function k(a){h(a.$,function(b){c[b]=_.without(c[b],a)})}function f(a,b,d){return l(arguments)==1?_.isObject(a)?(h(a,function(b,c){a[c]=f(c,b,d)}),a):e[a]:f[_.isFunction(b)?j:"set"](a,b,d)}var h=_.each,i=_.extend,l=_.size,j="on",e=p||{},g={},c={};h([j,"after","test"],function(a){f[a]=function(b,d){(d.$||(d.$=[])).push(a+b);(c[a+b]||(c[a+b]=[])).push(d);return d}});return i(f,{db:e,events:c,once:function(a,b){return i(f(a,b),{X:1})},setter:function(a,b){g[a]=b;a in e&&f.isset(a)},
isset:function(a,b){g[a]&&(g[a](),g[a]=0);return b?a in e?b(e[a]):f.once(a,b):a in e},set:function(a,b,d,g){var i="test"+a,m=l(c[i]),n,o={meta:d||{},old:e[a],key:a,done:function(c){n|=c===!1;--m||n||f.set(a,b,d,1)}};m&&!g?h(c[i],function(a){a(b,o)}):(e[a]=b,h((c[j+a]||[]).concat(c["after"+a]||[]),function(a){a(b,o);a.X&&k(a)}));return b},unset:function(a){delete e[a]},del:k})};
