function EvDa(p){function f(a,b,d){return m(arguments)==1?j(a)?(g(a,function(b,c){a[c]=f(c,b,d)}),a):e[a]:f[_.isFunction(b)?l:"set"](a,b,d)}function n(a){g(a.$,function(b){c[b]=_.without(c[b],a)})}function h(a,b){if(j(a))return g(a,function(b,c){a[c]=h(c,b)}),a;i[a]&&(i[a](),i[a]=0);return b?a in e?b(e[a]):f(a,b,q):a in e}var g=_.each,k=_.extend,j=_.isObject,m=_.size,l="on",q={once:1},e=p||{},i={},c={};g([l,"after","test"],function(a){f[a]=function(b,d,e){(d.$||(d.$=[])).push(a+b);(c[a+b]||(c[a+b]=
[])).push(d);return k(d,e)}});return k(f,{db:e,events:c,unset:function(a){delete e[a]},del:n,isset:h,setter:function(a,b){i[a]=b;c["on"+a]&&h(a)},set:function(a,b,d,i){var h="test"+a,j=m(c[h]),k,o={meta:d||{},old:e[a],key:a,done:function(c){k|=c===!1;--j||k||f.set(a,b,d,1)}};j&&!i?g(c[h],function(a){a(b,o)}):(e[a]=b,g((c[l+a]||[]).concat(c["after"+a]||[]),function(a){a.S||(a(b,o),a.once&&n(a))}));return b}})};
