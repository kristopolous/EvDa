function EvDa(p){function m(a,b,c){d[a]=b;h([i,n],function(d){h(q(f[d+a]),function(a){a(b,c);a.X&&o(a)})})}function r(a,b,c){function d(e){g+=e===!1;--i||g||m(a,b,c)}var e=j+a,i=k(f[e]),g=0;h(f[e],function(a){a(b,l(c,{done:d}))})}function o(a){h(a.$,function(b){f[b]=_.without(f[b],a)})}function e(a,b,c){return k(arguments)==1?_.isObject(a)?(h(a,function(b,c){a[c]=e(c,b)}),a):d[a]:e[_.isFunction(b)?i:"set"](a,b,c)}var h=_.each,l=_.extend,k=_.size,q=_.clone,j="test",i="when",n="after",d=p||{},g={},
f={};h([i,n,j],function(a){e[a]=function(b,c){(c.$||(c.$=[])).push(a+b);(f[a+b]||(f[a+b]=[])).push(c);return c}});return l(e,{data:d,events:f,once:function(a,b){return l(e[i](a,b),{X:1})},setter:function(a,b){g[a]=b;a in d&&e.isset(a)},isset:function(a,b){g[a]&&(g[a](),g[a]=0);return b?a in d?b(d[a]):e.once(a,b):a in d},set:function(a,b,c){b=k(arguments)-1?b:1;c={meta:c||{},old:d[a],key:a};f[j+a]?r(a,b,c):m(a,b,c);return b},unset:function(a){delete d[a]},del:o})};
