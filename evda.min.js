function EvDa(E){function F(a,b){var c={};return k(a)?(d(a,function(e){c[a]=b(a)}),c):b(a)}function c(a,b,g){if(!a)return{data:f,setters:l,events:h};if(k(a)){var e=q.call(arguments,1);return G(a,function(a){return c.apply(c.context,[a].concat(e))})}if(1==arguments.length){if(w(a)){var r={};d(a,function(a,b){r[a]=c(a,b,g,0,1)});d(r,function(b,c){n(r[b])&&!n(a[b])&&(a[b]=r[b]())});return a}return F(a,function(a){return f[a]})}return c[n(b)?v:"set"].apply(this,arguments)}function x(a){d(a.$,function(b){h[b]=
C(h[b],a)})}function p(a,b,g){if(k(a)){var e=a.pop();return p(e,function(c,g){return p(1==a.length?a[0]:a,b,g)},g)}if(w(a))return d(a,function(b,c){a[b]=p(b,c,g)}),a;l[a]&&(l[a](function(b){c.set.call(c.context,a,b,g)}),delete l[a]);return b?a in f?b.call(c.context,f[a],g):c(a,b,s(g||{},D)):a in f}var q=Array.prototype.slice,y=Object.prototype.toString,k=[].isArray||function(a){return"[object Array]"===y.call(a)},n=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},z=function(a){return!!(""===
a||a&&a.charCodeAt&&a.substr)},w=function(a){return z(a)?!1:null==a?"object"==String(a):"[object Object]"===y.call(a)||!0},d=[].forEach?function(a,b){if(k(a)||a.length)q.call(a).forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(k(a))for(var c=0,e=a.length;c<e;c++)b(a[c],c);else for(c in a)b(c,a[c])},A={}.keys||function(a){if(k(a))return a;var b=[],c;for(c in a)b.push(c);return b},C=function(a,b){var c=[];d(a,function(a){a!==b&&c.push(a)});return c},H=function(a){var b,c=[];d(A(a).sort(),
function(a){a!=b&&(b=a,c.push(a))});return c},I=function(a,b){var c=[];d(a,function(a){b(a)&&c.push(a)});return c},u=function(a){return a&&"length"in a?a.length:0},G=[].map?function(a,b){return a.map(b)}:function(a,b){for(var c=[],e=0,d=a.length;e<d;e++)c.push(b(a[e],e));return c},J=function(a){return k(a)?q.call(a):w(a)?s(a,{}):a},s=function(a){d(q.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])});return a},v="on",D={once:1},f=E||{},B=[],l={},h={};d([v,"after","test","or"],
function(a){c[a]=function(b,c,e){c||(c=b,b="__base");(c.$||(c.$=[])).push(a+b);(h[a+b]||(h[a+b]=[])).push(c);return s(c,e)}});s(c,{_:{},context:this,list:{},isPaused:!1,db:f,setterMap:l,events:h,del:x,whenSet:p,isset:p,pause:function(){return c.isPaused?!1:(c.isPaused=!0,c._.set=c.set,c.set=function(){B.push(["set",arguments])},!0)},play:function(){if(c.isPaused){c.isPaused=!1;var a=EvDa();c.set=c._.set;d(B,function(b){a[b[0]].apply(a,b[1])});B=[];c(a.db);return!0}return!1},setter:function(a,b){l[a]=
b;if(h[v+a])return p(a)},when:function(a,b,g){if(z(b))try{var e=new Function("x","return x"+b);e();b=e}catch(d){}return c(a,function(a){(k(b)&&b.sort().join("")===a.sort().join("")||n(b)&&b(a)||a===b)&&g.call(c.context,a)})},incr:function(a,b){b=b||1;return c.set(a,"[object Number]"===y.call(f[a])?f[a]+b:b)},decr:function(a,b){return c.set(a,f[a]-(b||1)||0)},push:function(a,b){1==u(arguments)&&(b=a,a="__base");return c.set(a,[].concat(f[a]||[],[b]))},pop:function(a){return c.set(a||"__base",f[a].slice(0,
-1))},traceList:[],group:function(a){var b=q.call(arguments);a=b.shift();b=c.apply(0,b);c.list[a]||(c.list[a]=[]);n(b)?c.list[a].push(b):d(b,function(b,e){c.list[a].push(b)});return function(){return c.group.apply(0,[a].concat(q.call(arguments)))}},set:function(a,b,g,e,r){var m="test"+a,k=q.call(arguments),l=u(h[m]),p=l&&!e,n,t=p?function(e){n|=!1===e;--l||(n?d(h["or"+a]||[],function(a){a.S||(a.call(c.context,b,g),a.once&&x(a))}):c.set(a,b,g,1))}:{};t.old=J(f[a]);s(t,{meta:g||{},done:t,result:t,key:a});
if(p)d(h[m],function(a){a.call(c.context,b,t)});else return d(c.traceList,function(a){a.call(c.context,k)}),f[a]=b,m=function(){d((h[v+a]||[]).concat(h["after"+a]||[]),function(a){a.S||(a.call(c.context,b,t),a.once&&x(a))});return b},r?m:m.call(c.context);return f[a]},once:function(a,b,g){return b?c.once(c(a,b,g)):s(a,D)},enable:function(a){d(c.list[a],function(b){b.S&&b.S[a]&&delete b.S[a];0==u(b.S)&&delete b.S});return c.list[a]},setadd:function(a,b){return c(a,H((f[a]||[]).concat([b])))},setdel:function(a,
b){return c(a,C(f[a]||[],b))},disable:function(a){d(c.list[a],function(b){(b.S||(b.S={}))[a]=!0});return c.list[a]},unset:function(){var a=!0;d(arguments,function(b){a&=b in f;delete f[b]});return a},find:function(a){return I(A(f),function(b){return b.match(a)})},changed:function(a,b){b||(b=a,a="__base");return c.on(a,function(a,e){var d=u(a),m=u(e.old);1==d-m?b.call(c.context,a.length?a[a.length-1]:void 0):d>m&&b.call(c.context,q.call(a).slice(m))})},sniff:function(){var a={},b=+new Date,d=function(c){a[c[0]]||
console.log(+new Date-b,c)},e=function(){},f=d;c.traceList.unshift(function(a){f(a)});c.sniff=function(b){if(0<arguments.length){if(z(b))return a[b]=!a[b],"[Un]ignoring "+b;f=b?d:e;return b}return A(a)}}});c.setAdd=c.setadd;c.setDel=c.setdel;c.isSet=c.isset;c.get=c;c.change=c.on;c.add=c.push;c.isArray=k;return c};
