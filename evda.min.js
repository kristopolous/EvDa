function EvDa(a){function J(a){return a.match(/[?*]/)}function K(a,b){return J(a)?q(n(b?b:D),function(b){return b.match(a)}):a}function L(a,b){var c={};return d(a)?(k(a,function(a){c[a]=b(a)}),c):b(a)}function M(a){if(a in D)return D[a];var b=a.split("."),c=b.pop(),d=b.join(".");if(d){var e=M(d);if(i(e)&&c in e)return e[c]}}function N(a,c,f,g){if(0===arguments.length)return{data:D,events:I,globs:H};if(d(a)){var h=b.call(arguments,1);return s(a,function(a){return N.apply(N.context,[a].concat(h))})}if(i(a)){var j={};return g=f||{},f=c,g.noexec=1,k(a,function(a,b){j[a]=N(a,b,f,g)}),g.bypass||k(j,function(b){e(j[b])&&!e(a[b])&&(a[b]=j[b]())}),R(n(j)[0]),a}return 1==arguments.length?L(a,M):N[e(c)||d(c)&&e(c[0])?w:"set"].apply(this,arguments)}function O(a){k(a.$,function(b){var c=J(b)?H:I;c[b]=o(c[b],a)})}function P(a,b,c){if(d(a)){var e=a.pop();return P(K(e),function(c,d){var e=1==a.length?a[0]:a;return P(e,b,d)},c)}if(i(a))return k(a,function(b,d){J(b)?u(b,L(b,function(){return P(b,d,c)})):a[b]=P(b,d,c)}),a;var f="set"+a;return I[f]&&(I[f](function(b){N.set.call(N.context,a,b,c)}),delete I[f]),b?a in D?b.call(N.context,D[a],c):N(a,b,u(c||{},A)):a in D}function Q(a,b,c,d){a.S||(a.call(b,c,d),a.once&&O(a))}function R(a){var c=a.split("."),d=c.pop();parts_obj=[],parts_obj[d]=D[a],N.extend.apply(N.context,[c.join("."),parts_obj].concat(b.call(arguments,1)))}var b=Array.prototype.slice,c=Object.prototype.toString,d=[].isArray||function(a){return"[object Array]"===c.call(a)},e=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},f=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},g=function(a){return"[object Number]"===c.call(a)},h=function(a){return f(a)||g(a)},i=function(a){return e(a)||f(a)||g(a)||d(a)?!1:null==a?"object"==String(a):"[object Object]"===c.call(a)||!0},j=function(a){return b.call(a)},k=[].forEach?function(a,b){if(h(a))return k([a],b);if(d(a)||a.length)j(a).forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(h(a))return k([a],b);if(d(a))for(var c=0,e=a.length;e>c;c++)b(a[c],c);else for(var f in a)b(f,a[f])},l=function(a){return a.length?a[a.length-1]:void 0},m=function(a){var b=[];for(var c in a)b.push(a[c]);return b},n={}.keys||function(a){if(d(a))return a;var b=[];for(var c in a)b.push(c);return b},o=function(a,b){var c=[];return k(a,function(a){a!==b&&c.push(a)}),c},p=function(a){var b,c=[];return k(n(a).sort(),function(a){a!=b&&(b=a,c.push(a))}),c},q=function(a,b){var c=[];return k(a,function(a){b(a)&&c.push(a)}),c},r=function(a){return a&&"length"in a?a.length:0},s=[].map?function(a,b){return a.map(b)}:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b(a[d],d));return c},t=function(a){return d(a)?b.call(a):i(a)?u(a,{}):a},u=function(a){return k(b.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},v="first",w="on",x="after",y="or",z=[v,w,x,"test",y],A={once:1},B={},C={},D={},E={},G=[],H={},I={};return k(z,function(a){N[a]=function(c,f,g){if(d(f)){var h=b.call(arguments,2);return s(f,function(b){return N[a].apply(N.context,[c,b].concat(h))})}var i=I;return f?((f.$||(f.$=[])).push(a+c),J(c)&&(i=H),(i[a+c]||(i[a+c]=[])).push(f),k(z,function(a){a in f||(f[a]=function(d){var g=b.call(arguments);return e(d)&&(g=[c].concat(g)),"len"in f||(f[0]=f,f.len=0),f.len++,f[f.len]=N[a].apply(N.context,g),f})}),u(f,g)):i[a+c]}}),u(N,{_:{},context:this,list:{},isPaused:!1,db:D,events:function(a,b){return b?I[b+a]:a?L(z.concat(["set"]),function(b){return I[b+a]}):I},del:O,whenSet:P,isset:P,pause:function(){return N.isPaused?!1:(N.isPaused=!0,N._.set=N.set,N.set=function(){G.push(["set",arguments])},!0)},play:function(){if(N.isPaused){N.isPaused=!1;var a=EvDa();return N.set=N._.set,k(G,function(b){a[b[0]].apply(a,b[1])}),G=[],N(a.db),!0}return!1},setter:function(a,b){return I["set"+a]=b,I[w+a]?P(a):void 0},when:function(a,c,g){if(i(a)){var h={},j={},l=function(a,b){j[b.key]=!1,b()},n=function(a,d){j[d.key]=!0,-1==m(j).indexOf(!1)&&c.apply(N.context,b.call(arguments))};return k(a,function(a,b){h[a+"-test"]=N.test(a,l),h[a]=N.when(a,b,n),j[a]=!1}),h}if(f(c))try{var o=new Function("x","return x"+c);o(),c=o}catch(p){}else if(2==arguments.length)return N.isset(a,c);return N(a,function(a){(d(c)&&c.sort().join("")===a.sort().join("")||e(c)&&c(a)||a===c)&&g.apply(N.context,b.call(arguments))})},empty:function(){for(var a in D)delete D[a]},incr:function(a,b,c){return b=b||1,N.set(a,g(D[a])?D[a]+b:b,c)},decr:function(a,b,c){return b=b||1,N.set(a,D[a]-b||0,c)},push:function(a,b,c){return N.set(a,[].concat(D[a]||[],[b]),c)},pop:function(a,b){return N.set(a,D[a].slice(0,-1),b)},traceList:[],group:function(a){var b=j(arguments),a=b.shift(),c=N.apply(0,b);return N.list[a]||(N.list[a]=[]),e(c)?N.list[a].push(c):k(c,function(b){N.list[a].push(b)}),function(){return N.group.apply(0,[a].concat(j(arguments)))}},extend:function(a,c){return N.set.apply(N.context,[a,u({},D[a]||{},c)].concat(b.call(arguments,2)))},count:function(a){return 0===arguments.length?Math.max.apply(this,m(E)):E[a]},set:function(a,c,d,e){e=e||{};var f,g=e.bypass,h=e.coroutine||function(){return!0},i="value"in e,j=e.noexec;if(1==arguments.length){var l=function(){N.set.apply(N.context,[a].concat(b.call(arguments)))};return N.set.call(N.context,a,void 0),l}if(B[a]>0)return D[a];B[a]=(B[a]||0)+1;var n,z,m="test"+a,o=b.call(arguments),p=r(I[m]),q=0,s=p&&!g,A=function(){k(I[y+a]||[],function(a){Q(a,N.context,i?e.value:F.value,F,F.meta)})},F=s?function(b){return z|=b===!1,--p?(q++,h(F,!1)?(f=I[m][q].call(N.context,i?e.value:F.value,F,F.meta),(f===!0||f===!1)&&F(f)):A()):z?A():h(F,!0)?N.set(a,F.value,F.meta,{bypass:1}):A(),b}:{};if(F.old=t(D[a]),u(F,{meta:d||{},done:F,result:F,key:a,value:c}),s)B[a]--,C[a]!==!0&&(C[a]=!0,h(F,!1)?(f=I[m][q].call(N.context,i?e.value:F.value,F,F.meta),(f===!0||f===!1)&&F(f)):A(),C[a]=!1),n=D[a];else if(k(N.traceList,function(a){a.call(N.context,o)}),h(F,!0)&&(c=F.value,!e.onlychange||c!==D[a])){e.noset||(D[a]=c,""!=a&&(E[a]=(E[a]||0)+1));var G=arguments,H=function(){return k((I[v+a]||[]).concat(I[w+a]||[]),function(a){F.last=Q(a,N.context,c,F)}),a.length>0&&(delete e.coroutine,R.apply(N.context,[a].concat(b.call(G,2)))),k(I[x+a]||[],function(a){F.last=Q(a,N.context,c,F)}),c};n=j?H:H.call(N.context)}return B[a]=0,n},fire:function(a,b){k(a,function(a){N.set(a,D[a],b,{noset:!0})})},once:function(a,b,c){return i(a)&&(a=m(a)),d(a)?s(a,function(a){N.once.call(N.context,a,b,c)}):b?N.once(N(a,b,c)):u(a,A)},enable:function(a){return k(N.list[a],function(b){b.S&&b.S[a]&&delete b.S[a],0==r(b.S)&&delete b.S}),N.list[a]},osetadd:function(a,b,c){var e=D[a]||[];return N(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=t(e),k(c,function(b){-1==a.set.indexOf(b)&&a.set.push(b)}),b&&(a.value=a.set),e.length!=a.set.length}})},setadd:function(a,b,c){var e=D[a]||[];return N(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=p(e.concat(c)),b&&(a.value=a.set),e.length!=a.set.length}})},settoggle:function(a,b,c){var d=-1===(D[a]||[]).indexOf(b)?"add":"del";return N["set"+d](a,b,c)},setdel:function(a,b,c){var d=D[a]||[],e=o(d,b);return d.length!=e.length?N(a,e,c,{value:b}):e},disable:function(a){return k(N.list[a],function(b){(b.S||(b.S={}))[a]=!0}),N.list[a]},unset:function(){var a=!0;return k(arguments,function(b){a&=b in D;var g,h,i,c=b.split("."),d="",e=c.length,f=c[e-1];for(g=0;e>g;g++)if(d=c.slice(0,g).join("."),i=D[d]){for(h=g;e-1>h;h++)i=i[c[h]];delete i[f]}delete D[b]}),a},find:function(a){return q(n(D),function(b){return b.match(a)})},changed:function(a,b){return N.on(a,function(a,c){var d=r(a),e=r(c.old);1==d-e?b.call(N.context,l(a)):d>e&&b.call(N.context,j(a).slice(e))})},sniff:function(){var a={},b=+new Date,c=function(c){a[c[0]]||console.log(+new Date-b,c)},d=function(){},e=c;N.traceList.unshift(function(a){e(a)}),N.sniff=function(b){return arguments.length>0?f(b)?(a[b]=!a[b],"[Un]ignoring "+b):(e=b?c:d,b):n(a)}}}),N.setAdd=N.setadd,N.setToggle=N.settoggle,N.osetAdd=N.osetadd,N.setDel=N.setdel,N.isSet=N.isset,N.get=N,N.change=N.on,N.add=N.push,N.isArray=d,arguments.length>0&&N(a),N}