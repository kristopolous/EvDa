function EvDa(a){function H(a){return a.match(/[?*]/)}function I(a,b){return H(a)?p(m(b?b:B),function(b){return b.match(a)}):a}function J(a,b){var c={};return d(a)?(j(a,function(a){c[a]=b(a)}),c):b(a)}function K(a){if(a in B)return B[a];var b=a.split("."),c=b.pop(),d=b.join(".");if(d){var e=K(d);if(h(e)&&c in e)return e[c]}}function L(a,c,f,g){if(0===arguments.length)return{data:B,events:G,globs:F};if(d(a)){var i=b.call(arguments,1);return r(a,function(a){return L.apply(L.context,[a].concat(i))})}if(h(a)){var k={};return g=f||{},f=c,g.noexec=1,j(a,function(a,b){k[a]=L(a,b,f,g)}),g.bypass||j(k,function(b){e(k[b])&&!e(a[b])&&(a[b]=k[b]())}),P(m(k)[0]),a}return 1==arguments.length?J(a,K):L[e(c)||d(c)&&e(c[0])?v:"set"].apply(this,arguments)}function M(a){j(a.$,function(b){var c=H(b)?F:G;c[b]=n(c[b],a)})}function N(a,b,c){if(d(a)){var e=a.pop();return N(I(e),function(c,d){var e=1==a.length?a[0]:a;return N(e,b,d)},c)}if(h(a))return j(a,function(b,d){H(b)?t(b,J(b,function(){return N(b,d,c)})):a[b]=N(b,d,c)}),a;var f="set"+a;return G[f]&&(G[f](function(b){L.set.call(L.context,a,b,c)}),delete G[f]),b?a in B?b.call(L.context,B[a],c):L(a,b,t(c||{},y)):a in B}function O(a,b,c,d){a.S||(a.call(b,c,d),a.once&&M(a))}function P(a){var c=a.split("."),d=c.pop();parts_obj=[],parts_obj[d]=B[a],L.extend.apply(L.context,[c.join("."),parts_obj].concat(b.call(arguments,1)))}var b=Array.prototype.slice,c=Object.prototype.toString,d=[].isArray||function(a){return"[object Array]"===c.call(a)},e=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},f=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},g=function(a){return"[object Number]"===c.call(a)},h=function(a){return e(a)||f(a)||g(a)||d(a)?!1:null==a?"object"==String(a):"[object Object]"===c.call(a)||!0},i=function(a){return b.call(a)},j=[].forEach?function(a,b){if(d(a)||a.length)i(a).forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(d(a))for(var c=0,e=a.length;e>c;c++)b(a[c],c);else for(var f in a)b(f,a[f])},k=function(a){return a.length?a[a.length-1]:void 0},l=function(a){var b=[];for(var c in a)b.push(a[c]);return b},m={}.keys||function(a){if(d(a))return a;var b=[];for(var c in a)b.push(c);return b},n=function(a,b){var c=[];return j(a,function(a){a!==b&&c.push(a)}),c},o=function(a){var b,c=[];return j(m(a).sort(),function(a){a!=b&&(b=a,c.push(a))}),c},p=function(a,b){var c=[];return j(a,function(a){b(a)&&c.push(a)}),c},q=function(a){return a&&"length"in a?a.length:0},r=[].map?function(a,b){return a.map(b)}:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b(a[d],d));return c},s=function(a){return d(a)?b.call(a):h(a)?t(a,{}):a},t=function(a){return j(b.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},u="first",v="on",w="after",x=[u,v,w,"test","or"],y={once:1},z={},A={},B=a||{},C={},E=[],F={},G={};return j(x,function(a){L[a]=function(c,d,e){if(_.isArray(d)){var f=b.call(arguments,2);return r(d,function(b){return L[a].apply(L.context,[c,b].concat(f))})}var g=G;return d?((d.$||(d.$=[])).push(a+c),H(c)&&(g=F),(g[a+c]||(g[a+c]=[])).push(d),t(d,e)):g[a+c]}}),t(L,{_:{},context:this,list:{},isPaused:!1,db:B,events:function(a,b){return b?G[b+a]:a?J(x.concat(["set"]),function(b){return G[b+a]}):G},del:M,whenSet:N,isset:N,pause:function(){return L.isPaused?!1:(L.isPaused=!0,L._.set=L.set,L.set=function(){E.push(["set",arguments])},!0)},play:function(){if(L.isPaused){L.isPaused=!1;var a=EvDa();return L.set=L._.set,j(E,function(b){a[b[0]].apply(a,b[1])}),E=[],L(a.db),!0}return!1},setter:function(a,b){return G["set"+a]=b,G[v+a]?N(a):void 0},when:function(a,c,g){if(h(a)){var i={},k={},m=function(a,b){k[b.key]=!1,b()},n=function(a,d){k[d.key]=!0,-1==l(k).indexOf(!1)&&c.apply(L.context,b.call(arguments))};return j(a,function(a,b){i[a+"-test"]=L.test(a,m),i[a]=L.when(a,b,n),k[a]=!1}),i}if(f(c))try{var o=new Function("x","return x"+c);o(),c=o}catch(p){}else if(2==arguments.length)return L.isset(a,c);return L(a,function(a){(d(c)&&c.sort().join("")===a.sort().join("")||e(c)&&c(a)||a===c)&&g.apply(L.context,b.call(arguments))})},empty:function(){for(var a in B)delete B[a]},incr:function(a,b,c){return b=b||1,L.set(a,g(B[a])?B[a]+b:b,c)},decr:function(a,b,c){return b=b||1,L.set(a,B[a]-b||0,c)},push:function(a,b,c){return L.set(a,[].concat(B[a]||[],[b]),c)},pop:function(a,b){return L.set(a,B[a].slice(0,-1),b)},traceList:[],group:function(a){var b=i(arguments),a=b.shift(),c=L.apply(0,b);return L.list[a]||(L.list[a]=[]),e(c)?L.list[a].push(c):j(c,function(b){L.list[a].push(b)}),function(){return L.group.apply(0,[a].concat(i(arguments)))}},extend:function(a,c){return L.set.apply(L.context,[a,t({},B[a]||{},c)].concat(b.call(arguments,2)))},count:function(a){return 0===arguments.length?Math.max.apply(this,l(C)):C[a]},set:function(a,c,d,e){e=e||{};var f,g=e.bypass,h=e.coroutine||function(){return!0},i="value"in e,k=e.noexec;if(1==arguments.length){var l=function(){L.set.apply(L.context,[a].concat(b.call(arguments)))};return L.set.call(L.context,a,void 0),l}if(z[a]>0)return B[a];z[a]=(z[a]||0)+1;var n,y,m="test"+a,o=b.call(arguments),p=q(G[m]),r=0,x=p&&!g,D=function(){j(G["or"+a]||[],function(a){O(a,L.context,i?e.value:E.value,E)})},E=x?function(b){return y|=b===!1,--p?(r++,h(E,!1)?(f=G[m][r].call(L.context,i?e.value:E.value,E),(f===!0||f===!1)&&E(f)):D()):y?D():h(E,!0)?L.set(a,E.value,E.meta,{bypass:1}):D(),b}:{};if(E.old=s(B[a]),t(E,{meta:d||{},done:E,result:E,key:a,value:c}),x)z[a]--,A[a]!==!0&&(A[a]=!0,h(E,!1)?(f=G[m][r].call(L.context,i?e.value:E.value,E),(f===!0||f===!1)&&E(f)):D(),A[a]=!1),n=B[a];else{if(j(L.traceList,function(a){a.call(L.context,o)}),!h(E,!0))return n;if(c=E.value,!e.onlychange||c!==B[a]){e.noset||(B[a]=c,""!=a&&(C[a]=(C[a]||0)+1));var F=arguments,H=function(){return j((G[u+a]||[]).concat(G[v+a]||[]),function(a){E.last=O(a,L.context,c,E)}),a.length>0&&P.apply(L.context,[a].concat(b.call(F,2))),j(G[w+a]||[],function(a){E.last=O(a,L.context,c,E)}),c};n=k?H:H.call(L.context)}}return z[a]=0,n},fire:function(a,b){L.set(a,B[a],b,{noset:!0})},once:function(a,b,c){return h(a)&&(a=l(a)),d(a)?r(a,function(a){L.once.call(L.context,a,b,c)}):b?L.once(L(a,b,c)):t(a,y)},enable:function(a){return j(L.list[a],function(b){b.S&&b.S[a]&&delete b.S[a],0==q(b.S)&&delete b.S}),L.list[a]},osetadd:function(a,b,c){var e=B[a]||[];return L(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=s(e),j(c,function(b){-1==a.set.indexOf(b)&&a.set.push(b)}),b&&(a.value=a.set),e.length!=a.set.length}})},setadd:function(a,b,c){var e=B[a]||[];return L(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=o(e.concat(c)),b&&(a.value=a.set),e.length!=a.set.length}})},setdel:function(a,b,c){var d=B[a]||[],e=n(d,b);return d.length!=e.length?L(a,e,c,{value:b}):e},disable:function(a){return j(L.list[a],function(b){(b.S||(b.S={}))[a]=!0}),L.list[a]},unset:function(){var a=!0;return j(arguments,function(b){a&=b in B;var g,h,i,c=b.split("."),d="",e=c.length,f=c[e-1];for(g=0;e>g;g++)if(d=c.slice(0,g).join("."),i=B[d]){for(h=g;e-1>h;h++)i=i[c[h]];delete i[f]}delete B[b]}),a},find:function(a){return p(m(B),function(b){return b.match(a)})},changed:function(a,b){return L.on(a,function(a,c){var d=q(a),e=q(c.old);1==d-e?b.call(L.context,k(a)):d>e&&b.call(L.context,i(a).slice(e))})},sniff:function(){var a={},b=+new Date,c=function(c){a[c[0]]||console.log(+new Date-b,c)},d=function(){},e=c;L.traceList.unshift(function(a){e(a)}),L.sniff=function(b){return arguments.length>0?f(b)?(a[b]=!a[b],"[Un]ignoring "+b):(e=b?c:d,b):m(a)}}}),L.setAdd=L.setadd,L.osetAdd=L.osetadd,L.setDel=L.setdel,L.isSet=L.isset,L.get=L,L.change=L.on,L.add=L.push,L.isArray=d,L}