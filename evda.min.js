function EvDa(a){function I(a){return a.match(/[?*]/)}function J(a,b){return I(a)?q(n(b?b:C),function(b){return b.match(a)}):a}function K(a,b){var c={};return d(a)?(k(a,function(a){c[a]=b(a)}),c):b(a)}function L(a){if(a in C)return C[a];var b=a.split("."),c=b.pop(),d=b.join(".");if(d){var e=L(d);if(i(e)&&c in e)return e[c]}}function M(a,c,f,g){if(0===arguments.length)return{data:C,events:H,globs:G};if(d(a)){var h=b.call(arguments,1);return s(a,function(a){return M.apply(M.context,[a].concat(h))})}if(i(a)){var j={};return g=f||{},f=c,g.noexec=1,k(a,function(a,b){j[a]=M(a,b,f,g)}),g.bypass||k(j,function(b){e(j[b])&&!e(a[b])&&(a[b]=j[b]())}),Q(n(j)[0]),a}return 1==arguments.length?K(a,L):M[e(c)||d(c)&&e(c[0])?w:"set"].apply(this,arguments)}function N(a){k(a.$,function(b){var c=I(b)?G:H;c[b]=o(c[b],a)})}function O(a,b,c){if(d(a)){var e=a.pop();return O(J(e),function(c,d){var e=1==a.length?a[0]:a;return O(e,b,d)},c)}if(i(a))return k(a,function(b,d){I(b)?u(b,K(b,function(){return O(b,d,c)})):a[b]=O(b,d,c)}),a;var f="set"+a;return H[f]&&(H[f](function(b){M.set.call(M.context,a,b,c)}),delete H[f]),b?a in C?b.call(M.context,C[a],c):M(a,b,u(c||{},z)):a in C}function P(a,b,c,d){a.S||(a.call(b,c,d),a.once&&N(a))}function Q(a){var c=a.split("."),d=c.pop();parts_obj=[],parts_obj[d]=C[a],M.extend.apply(M.context,[c.join("."),parts_obj].concat(b.call(arguments,1)))}var b=Array.prototype.slice,c=Object.prototype.toString,d=[].isArray||function(a){return"[object Array]"===c.call(a)},e=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},f=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},g=function(a){return"[object Number]"===c.call(a)},h=function(a){return f(a)||g(a)},i=function(a){return e(a)||f(a)||g(a)||d(a)?!1:null==a?"object"==String(a):"[object Object]"===c.call(a)||!0},j=function(a){return b.call(a)},k=[].forEach?function(a,b){if(h(a))return k([a],b);if(d(a)||a.length)j(a).forEach(b);else for(var c in a)b(c,a[c])}:function(a,b){if(h(a))return k([a],b);if(d(a))for(var c=0,e=a.length;e>c;c++)b(a[c],c);else for(var f in a)b(f,a[f])},l=function(a){return a.length?a[a.length-1]:void 0},m=function(a){var b=[];for(var c in a)b.push(a[c]);return b},n={}.keys||function(a){if(d(a))return a;var b=[];for(var c in a)b.push(c);return b},o=function(a,b){var c=[];return k(a,function(a){a!==b&&c.push(a)}),c},p=function(a){var b,c=[];return k(n(a).sort(),function(a){a!=b&&(b=a,c.push(a))}),c},q=function(a,b){var c=[];return k(a,function(a){b(a)&&c.push(a)}),c},r=function(a){return a&&"length"in a?a.length:0},s=[].map?function(a,b){return a.map(b)}:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b(a[d],d));return c},t=function(a){return d(a)?b.call(a):i(a)?u(a,{}):a},u=function(a){return k(b.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},v="first",w="on",x="after",y=[v,w,x,"test","or"],z={once:1},A={},B={},C=a||{},D={},F=[],G={},H={};return k(y,function(a){M[a]=function(c,e,f){if(d(e)){var g=b.call(arguments,2);return s(e,function(b){return M[a].apply(M.context,[c,b].concat(g))})}var h=H;return e?((e.$||(e.$=[])).push(a+c),I(c)&&(h=G),(h[a+c]||(h[a+c]=[])).push(e),u(e,f)):h[a+c]}}),u(M,{_:{},context:this,list:{},isPaused:!1,db:C,events:function(a,b){return b?H[b+a]:a?K(y.concat(["set"]),function(b){return H[b+a]}):H},del:N,whenSet:O,isset:O,pause:function(){return M.isPaused?!1:(M.isPaused=!0,M._.set=M.set,M.set=function(){F.push(["set",arguments])},!0)},play:function(){if(M.isPaused){M.isPaused=!1;var a=EvDa();return M.set=M._.set,k(F,function(b){a[b[0]].apply(a,b[1])}),F=[],M(a.db),!0}return!1},setter:function(a,b){return H["set"+a]=b,H[w+a]?O(a):void 0},when:function(a,c,g){if(i(a)){var h={},j={},l=function(a,b){j[b.key]=!1,b()},n=function(a,d){j[d.key]=!0,-1==m(j).indexOf(!1)&&c.apply(M.context,b.call(arguments))};return k(a,function(a,b){h[a+"-test"]=M.test(a,l),h[a]=M.when(a,b,n),j[a]=!1}),h}if(f(c))try{var o=new Function("x","return x"+c);o(),c=o}catch(p){}else if(2==arguments.length)return M.isset(a,c);return M(a,function(a){(d(c)&&c.sort().join("")===a.sort().join("")||e(c)&&c(a)||a===c)&&g.apply(M.context,b.call(arguments))})},empty:function(){for(var a in C)delete C[a]},incr:function(a,b,c){return b=b||1,M.set(a,g(C[a])?C[a]+b:b,c)},decr:function(a,b,c){return b=b||1,M.set(a,C[a]-b||0,c)},push:function(a,b,c){return M.set(a,[].concat(C[a]||[],[b]),c)},pop:function(a,b){return M.set(a,C[a].slice(0,-1),b)},traceList:[],group:function(a){var b=j(arguments),a=b.shift(),c=M.apply(0,b);return M.list[a]||(M.list[a]=[]),e(c)?M.list[a].push(c):k(c,function(b){M.list[a].push(b)}),function(){return M.group.apply(0,[a].concat(j(arguments)))}},extend:function(a,c){return M.set.apply(M.context,[a,u({},C[a]||{},c)].concat(b.call(arguments,2)))},count:function(a){return 0===arguments.length?Math.max.apply(this,m(D)):D[a]},set:function(a,c,d,e){e=e||{};var f,g=e.bypass,h=e.coroutine||function(){return!0},i="value"in e,j=e.noexec;if(1==arguments.length){var l=function(){M.set.apply(M.context,[a].concat(b.call(arguments)))};return M.set.call(M.context,a,void 0),l}if(A[a]>0)return C[a];A[a]=(A[a]||0)+1;var n,y,m="test"+a,o=b.call(arguments),p=r(H[m]),q=0,s=p&&!g,z=function(){k(H["or"+a]||[],function(a){P(a,M.context,i?e.value:E.value,E,E.meta)})},E=s?function(b){return y|=b===!1,--p?(q++,h(E,!1)?(f=H[m][q].call(M.context,i?e.value:E.value,E,E.meta),(f===!0||f===!1)&&E(f)):z()):y?z():h(E,!0)?M.set(a,E.value,E.meta,{bypass:1}):z(),b}:{};if(E.old=t(C[a]),u(E,{meta:d||{},done:E,result:E,key:a,value:c}),s)A[a]--,B[a]!==!0&&(B[a]=!0,h(E,!1)?(f=H[m][q].call(M.context,i?e.value:E.value,E,E.meta),(f===!0||f===!1)&&E(f)):z(),B[a]=!1),n=C[a];else if(k(M.traceList,function(a){a.call(M.context,o)}),h(E,!0)&&(c=E.value,!e.onlychange||c!==C[a])){e.noset||(C[a]=c,""!=a&&(D[a]=(D[a]||0)+1));var F=arguments,G=function(){return k((H[v+a]||[]).concat(H[w+a]||[]),function(a){E.last=P(a,M.context,c,E)}),a.length>0&&(delete e.coroutine,Q.apply(M.context,[a].concat(b.call(F,2)))),k(H[x+a]||[],function(a){E.last=P(a,M.context,c,E)}),c};n=j?G:G.call(M.context)}return A[a]=0,n},fire:function(a,b){k(a,function(a){M.set(a,C[a],b,{noset:!0})})},once:function(a,b,c){return i(a)&&(a=m(a)),d(a)?s(a,function(a){M.once.call(M.context,a,b,c)}):b?M.once(M(a,b,c)):u(a,z)},enable:function(a){return k(M.list[a],function(b){b.S&&b.S[a]&&delete b.S[a],0==r(b.S)&&delete b.S}),M.list[a]},osetadd:function(a,b,c){var e=C[a]||[];return M(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=t(e),k(c,function(b){-1==a.set.indexOf(b)&&a.set.push(b)}),b&&(a.value=a.set),e.length!=a.set.length}})},setadd:function(a,b,c){var e=C[a]||[];return M(a,b,c,{coroutine:function(a,b){var c=d(a.value)?a.value:[a.value];return a.set=p(e.concat(c)),b&&(a.value=a.set),e.length!=a.set.length}})},settoggle:function(a,b,c){var d=-1===(C[a]||[]).indexOf(b)?"add":"del";return M["set"+d](a,b,c)},setdel:function(a,b,c){var d=C[a]||[],e=o(d,b);return d.length!=e.length?M(a,e,c,{value:b}):e},disable:function(a){return k(M.list[a],function(b){(b.S||(b.S={}))[a]=!0}),M.list[a]},unset:function(){var a=!0;return k(arguments,function(b){a&=b in C;var g,h,i,c=b.split("."),d="",e=c.length,f=c[e-1];for(g=0;e>g;g++)if(d=c.slice(0,g).join("."),i=C[d]){for(h=g;e-1>h;h++)i=i[c[h]];delete i[f]}delete C[b]}),a},find:function(a){return q(n(C),function(b){return b.match(a)})},changed:function(a,b){return M.on(a,function(a,c){var d=r(a),e=r(c.old);1==d-e?b.call(M.context,l(a)):d>e&&b.call(M.context,j(a).slice(e))})},sniff:function(){var a={},b=+new Date,c=function(c){a[c[0]]||console.log(+new Date-b,c)},d=function(){},e=c;M.traceList.unshift(function(a){e(a)}),M.sniff=function(b){return arguments.length>0?f(b)?(a[b]=!a[b],"[Un]ignoring "+b):(e=b?c:d,b):n(a)}}}),M.setAdd=M.setadd,M.setToggle=M.settoggle,M.osetAdd=M.osetadd,M.setDel=M.setdel,M.isSet=M.isset,M.get=M,M.change=M.on,M.add=M.push,M.isArray=d,M}