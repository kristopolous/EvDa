function EvDa(u){function p(a,b,c){l("set",a,b);var i=e[a],f,d={};e[a]=b;g(m,function(e){f=h[e][a];g(f,function(f,e){d[e]=f(b,{meta:c,old:i,current:b,key:a,remove:function(){f.rm=1}})});g(f,function(a){a.rm&&n(a)})});j[a]=0;return d}function v(a,b,c){function d(e){f--;q+=e===!1;f||(q||p(a,b,c),j[a]=0)}var f=h.test[a].length,q=0;g(h.test[a],function(f){f(b,{meta:c,old:e[a],callback:d,key:a,remove:function(){n(f)}})})}function w(a){a.refs=[];o[a.ix=++x]=a}function n(a){g(a.refs,function(b){var c=b[0],
b=b[1];h[c][b]=_.without(h[c][b],a)});delete o[a.ix]}function y(a){var b={};g(r(d),function(c){b[c]=function(){d[c].apply(this,[a].concat(_.toArray(arguments)));return b}});return b}function d(a,b){var c=arguments.length,i={};if(c==0)return{data:e,events:h,functions:o};return c==1?_.isObject(a)?(g(a,function(a,b){i[b]=d(b,a)}),i):a.search(/[*?]/)+1?_.select(r(e),function(b){return b.match(a)}):e[a]:y(a)[_.isFunction(b)?"when":"run"](b)}var g=_.each,r=_.keys,s=_.extend,t=_.flatten,e=u||{},l=function(){},
k={},x=0,o={},m=["test","when","after"],h={},j={};g(m,function(a){h[a]={};d[a]=function(b,c){w(c);g(t([b]),function(b){h[a][b]=(h[a][b]||[]).concat(c);c.refs.push([a,b])});return s(d,{info:c})}});m.shift();return s(d,{once:function(a,b){var c=d.when(a,b);c.info.rm=1;return c},setter:function(a,b){k[a]=b;d.isset(a)},isset:function(a,b){k[a]&&(l("setter",a),k[a](),delete k[a]);return b?a in e?b(e[a]):d.once(a,b):a in e},firstset:d.isset,run:function(a,b,c){var d={};g(t([a]),function(a){j[a]||(j[a]=
1,d[a]=h.test[a]?v(a,b,c):p(a,b,c))});return d},on:d,set:function(a,b){return d(a,arguments.length==1?1:b)},unset:function(a){delete e[a]},debug:function(){l=console.log},remove:n})};
